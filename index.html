<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Goally - Goal Tracker</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Goally</h1>
            <p class="tagline">Track your goals, measure your progress</p>
            <button id="addGoalBtn" class="btn btn--primary icon-btn add-goal-header-btn" title="Add New Goal">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                <span class="addGoalBtnMain">Add Goal</span>
            </button>

            <!-- START: Add this new div for authentication -->
            <div id="authContainer" class="auth-container">
                <button id="signInBtn" class="btn btn--secondary">Sign In with Google</button>
                <div id="userProfile" style="display: none;">
                    <img id="userPhoto" src="" alt="User Photo">
                    <span id="userName"></span>
                    <button id="signOutBtn" class="btn btn--secondary btn--sm">Sign Out</button>
                </div>
            </div>
            <!-- END: Add this new div -->
        </header>

        <div id="goalsContainer" class="goals-container">
            <div class="empty-state" id="emptyState">
                <h2>Get started by creating your first goal!</h2>
                <p>Goals help you define what you want to achieve. Break them down into Key Results and Initiatives.</p>
                <button class="btn btn--primary" onclick="openAddGoalModal()">Create Your First Goal</button>
            </div>
        </div>
    </div>

    <!-- Add/Edit Goal Modal -->
    <div id="goalModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('goalModal')">&times;</span>
            <h2 id="goalModalTitle">Add Goal</h2>
            <form id="goalForm">
                <input type="hidden" id="goalId">
                <div class="form-group">
                    <label for="goalName" class="form-label">Goal Name *</label>
                    <input type="text" id="goalName" class="form-control" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn--secondary" onclick="closeModal('goalModal')">Cancel</button>
                    <button type="submit" class="btn btn--primary">Save Goal</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add/Edit KR Modal -->
    <div id="krModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('krModal')">&times;</span>
            <h2 id="krModalTitle">Add Key Result</h2>
            <form id="krForm">
                <input type="hidden" id="krId">
                <input type="hidden" id="krGoalId">
                <div class="form-group">
                    <label for="krName" class="form-label">Key Result Name *</label>
                    <input type="text" id="krName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="krWeight" class="form-label">Weight (%) *</label>
                    <input type="number" id="krWeight" class="form-control" min="0" max="100" step="0.01" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn--secondary" onclick="closeModal('krModal')">Cancel</button>
                    <button type="submit" class="btn btn--primary">Save Key Result</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add/Edit Initiative Modal -->
    <div id="initiativeModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('initiativeModal')">&times;</span>
            <h2 id="initiativeModalTitle">Add Initiative</h2>
            <form id="initiativeForm">
                <input type="hidden" id="initiativeId">
                <input type="hidden" id="initiativeKrId">
                <div class="form-group">
                    <label for="initiativeName" class="form-label">Initiative Name *</label>
                    <input type="text" id="initiativeName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="initiativeWeightLevel" class="form-label">Weight Level (1-5) *</label>
                    <div class="weight-level-selector">
                        <input type="range" id="initiativeWeightLevel" min="1" max="5" value="3" oninput="updateWeightLevelDisplay()">
                        <div class="weight-level-display">
                            <span id="weightLevelValue">3</span>
                            <span id="weightLevelLabel">Medium Priority</span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="initiativeStatus" class="form-label">Status *</label>
                    <select id="initiativeStatus" class="form-control" required>
                        <option value="Pending">Pending</option>
                        <option value="In Progress">In Progress</option>
                        <option value="Done">Done</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn--secondary" onclick="closeModal('initiativeModal')">Cancel</button>
                    <button type="submit" class="btn btn--primary">Save Initiative</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
    <script src="app.js"></script>
</body>
</html>